function sortedWordList(r){for(var t=[],e=0;r>e;e++){do var o=testWords[Math.floor(Math.random()*testWords.length)];while(-1!==t.indexOf(o));t.push(o)}return t.sort(function(r,t){return t.length-r.length})}function makePuzzle(r){var t=sortedWordList(r.numWords),e=0,o=[],n=[];for(r.directions.sort();e<t.length;){o=resize(o,t[e].length,"-");for(var a=!1,i=concatMatrices(o,t[e],r.directions.shuffle(),!0),l=0;l<i.length;l++){var s=insert({direction:i[l].direction,start:{row:i[l].row,col:i[l].col},word:t[e],grid:o,reverse:r.reversable?Math.floor(2*Math.random()):!1});s&&(a=!0,o=s.grid,n.push(s.key),l=i.length)}a?e++:o=resize(o,o.length+1,"-")}for(o=fillRandom(o),e=0;e<t.length;e++)console.log(t[e]);for(e=0;e<o.length;e++)console.log(o[e].join(""))}function blankPuzzle(r,t){for(var e=[],o=0;r>o;o++){for(var n=[],a=0;r>a;a++)n.push(t);e.push(n.slice())}return e}function deepCopy(r){var t=r instanceof Array?[]:{};for(var e in r)"object"==typeof r[e]?t[e]=deepCopy(r[e]):t[e]=r[e];return t}function randomLetter(){var r=Math.floor(26*Math.random());return"ABCDEFGHIJKLMNOPQRSTUVWXYZ"[r]}function resize(r,t,e){for(var o=deepCopy(r);o.length<t;)o.push([]);for(var n=0;n<o.length;n++)for(;o[n].length<t;)o[n].push(e);return o}function stepDirection(r){return"vertical"===r?{rowStep:1,colStep:0}:"diagonal up"===r?{rowStep:-1,colStep:1}:"diagonal down"===r?{rowStep:1,colStep:1}:{rowStep:0,colStep:1}}function insert(r){r=deepCopy(r);var t={start:r.start,direction:r.direction};r.direction=stepDirection(r.direction);for(var e=0;e<r.word.length;e++){var o=r.grid[r.start.row][r.start.col],n=r.reverse?r.word[r.word.length-(e+1)].toUpperCase():r.word[e].toUpperCase();if("-"===o)r.grid[r.start.row][r.start.col]=n;else if(o!==n)return!1;r.start.row+=r.direction.rowStep,r.start.col+=r.direction.colStep}return{grid:r.grid,key:t}}function fillRandom(r){for(var t=deepCopy(r),e=0;e<t.length;e++)for(var o=0;o<t[e].length;o++)"-"===t[e][o]&&(t[e][o]=randomLetter());return t}function range(r,t,e){for(var o=[],n=r;n<t+(Number(e)||0);n++)o.push(n);return o}function combinationRanges(r,t,e){for(var o=[],n=0;n<r.length;n++)for(var a=0;a<t.length;a++)o.push({row:r[n],col:t[a],direction:e});return o}function getMatrix(r,t,e){var o="diagonal up"===e?t.length-1:0,n=0,a="horizontal"===e||"diagonal up"===e?r.length-1:r.length-t.length,i="vertical"===e?r.length-1:r.length-t.length;return combinationRanges(range(o,a,!0),range(n,i,!0),e)}function concatMatrices(r,t,e,o){for(var n=[],a=0;a<e.length;a++)n=o?n.concat(getMatrix(r,t,e[a]).randomize()):n.concat(getMatrix(r,t,e[a]));return n}var testWords=["apple","pear","banana","otherfruit","zebra","cornacopia","razzledazzle","jumble","plankton","draught","carnivore","pheasant","test","data","fiber","soylent","sunflower","carbohydrate","fifth","constitution","metabolism","beets","oil","biohazard","natural","protein","improvement","profile","powder","rice","building","view","concert","power","garbage","onyx","gross","story","superfluous","arbitrary","stuff","conditional","gargantuan","dragon","fuss","magical","weeds","garden","incontrovertable","archenemy","claw","injuries","stump","wheel","octagonal","oyster"];Array.prototype.randomize=function(){return this.sort(function(){return Math.random()<.5?-1:1}),this},Array.prototype.shuffle=function(){return this.push(this.shift()),this},$(function(){makePuzzle({reversable:!1,directions:["vertical","horizontal"],numWords:30})});